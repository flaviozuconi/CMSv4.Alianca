@model MLModuloEventos
@{
    var portal = BLPortal.Atual;
}
<style type="text/css">
    .selectboxit-option, .selectboxit-optgroup-header { clear: both; }
    i.glyphicon { position: relative !important; top: inherit !important; font-family: 'Glyphicons Halflings'; }
    .selectboxit.selectboxit-disabled { -moz-box-shadow: 0px 0px !important; -webkit-box-shadow: 0px 0px !important; box-shadow: 0px 0px !important; background: #e0e0e0; }
</style>

<script type="text/javascript">
    var codigoidioma = '@BLIdioma.Atual.Codigo';
    var executandoAjax = false;

    function alterarLembrete(sender, i) {
        var l = $("#linkOutlook" + i);
        if (l.length) {
            l[0].search = "lembrete=" + $(sender).find("option:selected").val();
        }

        $('#carousel-example-generic_@Model.Repositorio').carousel({ interval: "10" });

    }

    $("#vermais_@Model.Repositorio").on("click", function () {
        var input = $(this);
        var textoAnterior = input.val();

        input.val("@T("Carregando...")");
        input.addClass("disabled");

        $.ajax({
            type: "GET",
            data: { "Pagina": $("#hdn_@Model.Repositorio").val(), "Quantidade": "@Model.Quantidade", "url": "@Portal.Url(Portal.UrlDiretorio(portal), Model.UrlDetalhe)", "idioma": codigoidioma },
            url: "@Portal.UrlCms(portal)/Evento/ListagemAjax",
            success: function (data) {
                if (parseInt($("#hdn_@Model.Repositorio").val()) >= parseInt(data.TotalPaginas)) {
                    $("#vermais_@Model.Repositorio").hide();
                }

                $("#divVerMais_@Model.Repositorio").append(data.view);
                $("#hdn_@Model.Repositorio").val(parseInt($("#hdn_@Model.Repositorio").val()) + 1);

                input.val(textoAnterior);
                input.removeClass("disabled");
            },
            error: function (err) {
                input.val(textoAnterior);
                input.removeClass("disabled");
            }
        });
    });


    $("#Pesquisar").on("click", function () {

        var sucesso = true;

        if ($('#Ano').val() == "") {
            $('#Ano').css("border", "red solid 1px");
            sucesso = false;
        }
        else {
            $('#Ano').css("border", "#A9A9A9 solid 1px");
        }

        if ($('#Semestre').val() == "") {
            $('#Semestre').css("border", "red solid 1px");
            sucesso = false;
        }
        else {
            $('#Semestre').css("border", "#A9A9A9 solid 1px");
        }
        if (sucesso == true) {
            $.ajax({
                type: 'GET',
                url: "@Portal.UrlCms(portal)/Evento/ajaxPesquisar",
                data: {
                    "Ano": $('#Ano').val(),
                    "Semestre": $('#Semestre').val(),
                    "url": $('#url').val()
                },
                success: function (data) {
                    if (data.success) {
                        $("#itemListagemComFiltro").html(data.html);
                    }
                },
                error: function (err) {
                }
            });
        }
    });

    function ListarAjaxCalendario(LimparConteudo) {
        executandoAjax = true;
        var e = $("#itemListagemComFiltro_@Model.Repositorio");

        $.ajax({
            type: "POST",
            url: "@Portal.UrlCms(portal)/evento/ListagemComFiltro",
            data: {
                "pintSemestre": $("#hdnSemestreSelecionado_@(Model.Repositorio)").val(),
                "pintAno": $("#hdnAnoSelecionado_@(Model.Repositorio)").val()
            },
            beforeSend: function () {
                channelingLoad(e);
            },
            success: function (data) {
                setTimeout(function () {
                    if (data.success) {
                        if (LimparConteudo) {
                            e.html(data.html);
                        }
                        else {
                            e.append(data.html);
                        }
                    }

                    doneLoad(e);
                    executandoAjax = false;
                }, 500);
            }
        });
    }

    //evento-lista-com-filtro
    $(document).ready(function () {
        $("#btnPesquisarEventoBraskem_@Model.Repositorio").click(function () {
            var semetre = $("#semestre_@(Model.Repositorio)").val();
            var ano = $("#anobraskem_@(Model.Repositorio)").val();

            //Definir Parametros de busca por data para paginação
            $("#hdnAnoSelecionado_@Model.Repositorio").val(ano);
            $("#hdnSemestreSelecionado_@Model.Repositorio").val(semetre);

            //Nova Busca
            ListarAjaxCalendario(true);
        });
    });
</script>